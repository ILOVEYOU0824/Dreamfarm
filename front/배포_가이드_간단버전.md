# 🚀 배포 가이드 (간단 버전)

## 📋 배포 순서
1. **백엔드 먼저 배포** (Render)
2. **프론트엔드 배포** (Netlify)
3. **연결 확인**

---

## 1️⃣ 백엔드 배포 (Render)

### Step 1: Render 계정 만들기
1. https://render.com 접속
2. "Get Started for Free" 클릭
3. GitHub 계정으로 로그인

### Step 2: 새 웹 서비스 만들기
1. 대시보드에서 "New +" 버튼 클릭
2. "Web Service" 선택
3. GitHub 저장소 연결 (또는 저장소 선택)
4. 다음 정보 입력:
   - **Name**: `my-backend` (원하는 이름)
   - **Region**: `Singapore` (가장 가까운 지역)
   - **Branch**: `main` (또는 `master`)
   - **Root Directory**: `back` ⚠️ 중요!
   - **Runtime**: `Node`
   - **Build Command**: (비워두기)
   - **Start Command**: `npm start`

### Step 3: 환경 변수 설정
"Environment" 섹션에서 다음 변수들을 추가:

```
PORT=3000
SUPABASE_URL=여기에_슈파베이스_URL_입력
SUPABASE_KEY=여기에_슈파베이스_KEY_입력
GEMINI_API_KEY=여기에_제미니_API_KEY_입력
GEMINI_MODEL=gemini-2.5-flash
FRONTEND_ORIGINS=https://your-frontend.netlify.app
```

⚠️ **주의**: `FRONTEND_ORIGINS`는 아직 프론트엔드 URL을 모르므로, 일단 비워두고 나중에 추가하세요.

### Step 4: 배포 시작
1. "Create Web Service" 버튼 클릭
2. 배포가 완료될 때까지 대기 (약 2-3분)
3. 배포 완료 후 URL 확인 (예: `https://my-backend.onrender.com`)
4. **이 URL을 복사해두세요!** 프론트엔드 배포 시 필요합니다.

---

## 2️⃣ 프론트엔드 배포 (Netlify)

### Step 1: Netlify 계정 만들기
1. https://www.netlify.com 접속
2. "Sign up" 클릭
3. GitHub 계정으로 로그인

### Step 2: 새 사이트 만들기
1. 대시보드에서 "Add new site" 클릭
2. "Import an existing project" 선택
3. GitHub 저장소 선택
4. 다음 설정 입력:
   - **Base directory**: `front` ⚠️ 중요!
   - **Build command**: `npm run build`
   - **Publish directory**: `dist`

### Step 3: 환경 변수 설정
"Site settings" → "Environment variables"에서 추가:

```
VITE_API_BASE=https://my-backend.onrender.com
VITE_USE_MOCK=0
```

⚠️ **주의**: `VITE_API_BASE`에는 위에서 복사한 백엔드 URL을 입력하세요!

### Step 4: 배포 시작
1. "Deploy site" 버튼 클릭
2. 배포가 완료될 때까지 대기 (약 1-2분)
3. 배포 완료 후 URL 확인 (예: `https://your-app.netlify.app`)
4. **이 URL을 복사해두세요!**

---

## 3️⃣ 백엔드 CORS 설정 업데이트

### Step 1: Render로 돌아가기
1. Render 대시보드로 이동
2. 배포한 백엔드 서비스 클릭

### Step 2: 환경 변수 업데이트
1. "Environment" 탭 클릭
2. `FRONTEND_ORIGINS` 변수 찾기
3. 값 수정: `https://your-app.netlify.app` (위에서 복사한 프론트엔드 URL)
4. "Save Changes" 클릭
5. 자동으로 재배포 시작

---

## ✅ 배포 완료 확인

### 1. 프론트엔드 접속
- Netlify에서 제공한 URL로 접속
- 로그인 페이지가 보이는지 확인

### 2. 브라우저 콘솔 확인
- F12 키 누르기
- Console 탭에서 에러가 없는지 확인
- `[API] API_BASE:` 로그에서 백엔드 URL이 올바른지 확인

### 3. 기능 테스트
- 로그인 테스트
- 학생 추가 테스트
- 파일 업로드 테스트

---

## 🔧 문제 해결

### 문제: CORS 에러
**해결**: Render의 `FRONTEND_ORIGINS`에 프론트엔드 URL이 정확히 입력되었는지 확인

### 문제: API 연결 실패
**해결**: 
1. Netlify의 `VITE_API_BASE`가 백엔드 URL을 가리키는지 확인
2. 백엔드 서버가 실행 중인지 확인 (Render 대시보드에서 확인)

### 문제: 환경 변수 미적용
**해결**: 
1. 환경 변수 저장 후 재배포
2. Netlify: "Trigger deploy" → "Clear cache and deploy site"
3. Render: "Manual Deploy" → "Deploy latest commit"

---

## 📝 체크리스트

### 백엔드 (Render)
- [ ] Render 계정 생성 완료
- [ ] Web Service 생성 완료
- [ ] Root Directory: `back` 설정
- [ ] Start Command: `npm start` 설정
- [ ] 환경 변수 모두 입력 완료
- [ ] 배포 완료 및 URL 확인

### 프론트엔드 (Netlify)
- [ ] Netlify 계정 생성 완료
- [ ] 사이트 생성 완료
- [ ] Base directory: `front` 설정
- [ ] Build command: `npm run build` 설정
- [ ] Publish directory: `dist` 설정
- [ ] `VITE_API_BASE` 환경 변수 설정 (백엔드 URL)
- [ ] 배포 완료 및 URL 확인

### 연결
- [ ] 백엔드 `FRONTEND_ORIGINS`에 프론트엔드 URL 추가
- [ ] 재배포 완료
- [ ] 기능 테스트 완료

---

## 💡 팁

1. **백엔드를 먼저 배포**: 프론트엔드가 백엔드 URL을 알아야 하므로
2. **URL 복사해두기**: 각 단계에서 생성된 URL을 메모장에 저장
3. **환경 변수 확인**: 배포 후에도 환경 변수가 올바른지 다시 확인
4. **재배포**: 환경 변수 변경 후 자동 재배포되지만, 수동으로도 가능

